<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Lead Leak Audit — TradeStack AI</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Fraunces:ital,opsz,wght@0,9..144,400;0,9..144,700;0,9..144,800;0,9..144,900;1,9..144,400;1,9..144,700&family=Syne:wght@400;600;700;800&family=DM+Sans:ital,wght@0,300;0,400;0,500;0,600;1,400&display=swap" rel="stylesheet">
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    :root {
      --charcoal:   #1C1917;
      --amber:      #E8652A;
      --amber-lt:   #F5804A;
      --amber-dk:   #C4501B;
      --cream:      #FAF9F6;
    }

    html, body {
      height: 100%;
      background: var(--charcoal);
      color: white;
      font-family: 'DM Sans', sans-serif;
      -webkit-font-smoothing: antialiased;
    }

    /* ─── Header ─── */
    .audit-nav {
      position: fixed; top: 0; left: 0; right: 0; z-index: 100;
      padding: 20px 40px;
      display: flex; align-items: center; justify-content: space-between;
      background: linear-gradient(to bottom, rgba(28,25,23,0.95), transparent);
    }
    .audit-logo {
      font-family: 'Syne', sans-serif; font-size: 16px; font-weight: 800;
      letter-spacing: 0.04em; text-transform: uppercase;
      color: white; text-decoration: none;
    }
    .audit-logo span { color: var(--amber); }
    .audit-logo-badge {
      display: inline-block; background: var(--amber); color: white !important;
      font-family: 'Syne', sans-serif; font-size: 9px; font-weight: 800;
      letter-spacing: 0.04em; padding: 4px 7px; border-radius: 3px;
      line-height: 1; vertical-align: middle; position: relative; top: -1px;
    }
    .audit-nav-back {
      font-family: 'DM Sans', sans-serif; font-size: 13px;
      color: rgba(255,255,255,0.35); text-decoration: none;
      display: flex; align-items: center; gap: 6px;
      transition: color 0.2s;
    }
    .audit-nav-back:hover { color: rgba(255,255,255,0.7); }

    /* ─── Main layout ─── */
    .audit-page {
      min-height: 100vh;
      display: flex; align-items: center; justify-content: center;
      padding: 100px 40px 60px;
      position: relative; overflow: hidden;
    }
    .audit-page::before {
      content: '';
      position: absolute; top: -200px; right: -200px;
      width: 700px; height: 700px;
      background: radial-gradient(circle, rgba(232,101,42,0.07) 0%, transparent 70%);
      pointer-events: none;
    }
    .audit-page::after {
      content: '';
      position: absolute; bottom: -150px; left: -150px;
      width: 500px; height: 500px;
      background: radial-gradient(circle, rgba(232,101,42,0.04) 0%, transparent 70%);
      pointer-events: none;
    }
    .audit-wm {
      position: fixed; pointer-events: none; user-select: none;
      right: -2%; top: 50%; transform: translateY(-50%);
      font-family: 'Fraunces', Georgia, serif; font-weight: 900;
      font-size: clamp(140px, 20vw, 300px); line-height: 1;
      letter-spacing: -0.04em; color: rgba(255,255,255,0.03);
      z-index: 0;
    }

    /* ─── Panels ─── */
    .lla-wrap {
      max-width: 860px; width: 100%;
      position: relative; z-index: 1;
    }
    .lla-panel { display: none; flex-direction: column; width: 100%; }
    .lla-panel.active {
      display: flex;
      animation: llaIn 0.42s cubic-bezier(.4,0,.2,1);
    }
    @keyframes llaIn {
      from { opacity: 0; transform: translateY(18px); }
      to   { opacity: 1; transform: none; }
    }

    /* ─── Typography ─── */
    .lla-eyebrow-amber {
      font-family: 'Syne', sans-serif; font-size: 11px; font-weight: 700;
      letter-spacing: 0.12em; text-transform: uppercase;
      color: var(--amber); margin-bottom: 20px;
    }
    .lla-h2 {
      font-family: 'Fraunces', Georgia, serif;
      font-size: clamp(38px, 5.5vw, 68px);
      font-weight: 800; line-height: 1.04; letter-spacing: -0.03em;
      color: white; margin-bottom: 20px;
    }
    .lla-lead {
      font-family: 'DM Sans', sans-serif; font-size: 17px; line-height: 1.65;
      color: rgba(255,255,255,0.55); max-width: 560px; margin-bottom: 36px;
    }
    .lla-qh {
      font-family: 'Fraunces', Georgia, serif;
      font-size: clamp(24px, 3.5vw, 40px); font-weight: 700;
      line-height: 1.15; letter-spacing: -0.02em;
      color: white; margin-bottom: 14px;
    }
    .lla-qlead {
      font-family: 'DM Sans', sans-serif; font-size: 16px; line-height: 1.6;
      color: rgba(255,255,255,0.45); margin-bottom: 32px; max-width: 480px;
    }

    /* ─── Category pills ─── */
    .lla-cats-row { display: flex; flex-wrap: wrap; gap: 10px; margin-bottom: 44px; }
    .lla-cat-pill {
      font-family: 'Syne', sans-serif; font-size: 11px; font-weight: 600;
      letter-spacing: 0.05em; color: rgba(255,255,255,0.4);
      border: 1px solid rgba(255,255,255,0.12); border-radius: 100px; padding: 5px 13px;
    }

    /* ─── Buttons ─── */
    .lla-btn-primary {
      display: inline-flex; align-items: center; gap: 10px;
      background: var(--amber); color: white;
      font-family: 'Syne', sans-serif; font-size: 15px; font-weight: 700;
      letter-spacing: 0.02em; border: none; border-radius: 4px;
      padding: 16px 28px; cursor: pointer; align-self: flex-start;
      text-decoration: none;
      transition: background 0.2s, transform 0.15s;
    }
    .lla-btn-primary:hover { background: var(--amber-lt); transform: translateY(-1px); }
    .lla-btn-primary:active { transform: none; }
    .lla-fine {
      font-family: 'DM Sans', sans-serif; font-size: 13px;
      color: rgba(255,255,255,0.25); margin-top: 16px;
    }

    /* ─── Value input ─── */
    .lla-input-row { display: flex; align-items: center; gap: 14px; flex-wrap: wrap; margin-bottom: 18px; }
    .lla-input-wrap {
      display: flex; align-items: center;
      background: rgba(255,255,255,0.05);
      border: 1.5px solid rgba(255,255,255,0.14); border-radius: 4px;
      overflow: hidden; transition: border-color 0.2s;
    }
    .lla-input-wrap:focus-within { border-color: var(--amber); }
    .lla-curr {
      font-family: 'Fraunces', Georgia, serif; font-size: 22px; font-weight: 700;
      color: rgba(255,255,255,0.4); padding: 13px 0 13px 18px;
    }
    .lla-num-input {
      background: transparent; border: none; outline: none;
      font-family: 'Fraunces', Georgia, serif; font-size: 22px; font-weight: 700;
      color: white; padding: 13px 18px; width: 160px;
    }
    .lla-num-input::placeholder { color: rgba(255,255,255,0.2); }
    .lla-skip-link {
      font-family: 'DM Sans', sans-serif; font-size: 13px;
      color: rgba(255,255,255,0.28); cursor: pointer;
      text-decoration: underline; text-underline-offset: 3px;
      transition: color 0.2s; display: inline-block; margin-top: 4px;
    }
    .lla-skip-link:hover { color: rgba(255,255,255,0.55); }
    /* Capture panel */
    .lla-capture-fields { display: flex; flex-direction: column; gap: 12px; margin: 28px 0 20px; max-width: 440px; }
    .lla-text-input {
      background: rgba(255,255,255,0.05);
      border: 1.5px solid rgba(255,255,255,0.14); border-radius: 4px;
      color: white; font-family: 'DM Sans', sans-serif; font-size: 15px;
      padding: 14px 18px; outline: none; width: 100%;
      transition: border-color 0.2s;
    }
    .lla-text-input::placeholder { color: rgba(255,255,255,0.25); }
    .lla-text-input:focus { border-color: var(--amber); }
    .lla-capture-error { color: #e05a5a; font-size: 13px; margin-top: -4px; display: none; }
    .lla-capture-error.show { display: block; }
    .lla-privacy-note { font-size: 12px; color: rgba(255,255,255,0.28); margin-top: 14px; line-height: 1.6; }

    /* ─── Progress bar ─── */
    .lla-progress-track {
      width: 100%; height: 2px;
      background: rgba(255,255,255,0.08); border-radius: 2px;
      margin-bottom: 40px; overflow: hidden;
    }
    .lla-progress-fill {
      height: 100%; background: var(--amber); border-radius: 2px;
      width: 0%; transition: width 0.55s cubic-bezier(.4,0,.2,1);
    }
    .lla-q-meta-row {
      display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;
    }
    .lla-q-section-lbl {
      font-family: 'Syne', sans-serif; font-size: 11px; font-weight: 700;
      letter-spacing: 0.1em; text-transform: uppercase; color: var(--amber);
    }
    .lla-q-counter {
      font-family: 'DM Sans', sans-serif; font-size: 13px; color: rgba(255,255,255,0.3);
    }

    /* ─── Answer options ─── */
    .lla-opts { display: flex; flex-direction: column; gap: 10px; margin-top: 28px; }
    .lla-opt {
      background: rgba(255,255,255,0.04);
      border: 1.5px solid rgba(255,255,255,0.09); border-radius: 6px;
      padding: 15px 20px; text-align: left;
      font-family: 'DM Sans', sans-serif; font-size: 15px;
      color: rgba(255,255,255,0.7); cursor: pointer;
      transition: background 0.15s, border-color 0.15s, color 0.15s, transform 0.12s;
    }
    .lla-opt:hover {
      background: rgba(232,101,42,0.1); border-color: rgba(232,101,42,0.5);
      color: white; transform: translateX(5px);
    }
    .lla-opt.selected {
      background: var(--amber); border-color: var(--amber);
      color: white; font-weight: 600; transform: translateX(5px);
    }

    /* ─── Results ─── */
    .lla-results-grid {
      display: grid; grid-template-columns: 1fr 1fr; gap: 56px; width: 100%;
    }
    .lla-tier-badge {
      display: inline-block; font-family: 'Syne', sans-serif;
      font-size: 10px; font-weight: 700; letter-spacing: 0.1em; text-transform: uppercase;
      padding: 5px 12px; border-radius: 3px; margin-bottom: 14px;
    }
    .lla-tier-solid    { background: rgba(100,200,120,0.15); color: #7CCC8A; }
    .lla-tier-moderate { background: rgba(232,101,42,0.15);  color: var(--amber-lt); }
    .lla-tier-critical { background: rgba(210,60,60,0.15);   color: #E57373; }
    .lla-tier-desc {
      font-family: 'DM Sans', sans-serif; font-size: 15px; line-height: 1.6;
      color: rgba(255,255,255,0.5); margin-bottom: 32px;
    }
    .lla-leak-num {
      font-family: 'Fraunces', Georgia, serif;
      font-size: clamp(44px, 6vw, 72px); font-weight: 900;
      color: var(--amber); line-height: 1; letter-spacing: -0.03em; margin-bottom: 8px;
    }
    .lla-leak-lbl {
      font-family: 'DM Sans', sans-serif; font-size: 12px;
      color: rgba(255,255,255,0.3); text-transform: uppercase;
      letter-spacing: 0.07em; margin-bottom: 32px;
    }
    .lla-score-row {
      display: flex; align-items: center; gap: 12px;
      padding-top: 24px; border-top: 1px solid rgba(255,255,255,0.07);
    }
    .lla-score-lbl { font-family: 'DM Sans', sans-serif; font-size: 13px; color: rgba(255,255,255,0.35); }
    .lla-score-val { font-family: 'Fraunces', Georgia, serif; font-size: 24px; font-weight: 700; color: white; }
    .lla-gaps-title {
      font-family: 'Syne', sans-serif; font-size: 10px; font-weight: 700;
      letter-spacing: 0.1em; text-transform: uppercase;
      color: rgba(255,255,255,0.35); margin-bottom: 22px;
    }
    .lla-gap-row { margin-bottom: 18px; }
    .lla-gap-meta { display: flex; justify-content: space-between; align-items: center; margin-bottom: 7px; }
    .lla-gap-name { font-family: 'DM Sans', sans-serif; font-size: 13px; font-weight: 600; color: rgba(255,255,255,0.75); }
    .lla-gap-tag {
      font-family: 'Syne', sans-serif; font-size: 9px; font-weight: 700;
      letter-spacing: 0.08em; text-transform: uppercase; padding: 2px 7px; border-radius: 3px;
    }
    .lla-gap-tag-major    { background: rgba(210,60,60,0.2);   color: #E57373; }
    .lla-gap-tag-moderate { background: rgba(232,101,42,0.2);  color: var(--amber-lt); }
    .lla-gap-tag-strong   { background: rgba(100,200,120,0.15); color: #7CCC8A; }
    .lla-gap-track { height: 4px; background: rgba(255,255,255,0.07); border-radius: 2px; overflow: hidden; margin-bottom: 5px; }
    .lla-gap-fill { height: 100%; border-radius: 2px; width: 0%; transition: width 1.1s cubic-bezier(.4,0,.2,1); }
    .lla-gap-fill-major    { background: #E57373; }
    .lla-gap-fill-moderate { background: var(--amber); }
    .lla-gap-fill-strong   { background: #7CCC8A; }
    .lla-gap-svc { font-family: 'DM Sans', sans-serif; font-size: 11px; color: rgba(255,255,255,0.28); }
    .lla-gap-svc strong { color: rgba(255,255,255,0.5); }
    .lla-res-cta { margin-top: 28px; padding-top: 24px; border-top: 1px solid rgba(255,255,255,0.07); }
    .lla-res-cta-btn { width: 100%; justify-content: center; display: flex; align-items: center; gap: 8px; }
    .lla-btn-download {
      display: flex; align-items: center; justify-content: center; gap: 8px;
      width: 100%; margin-top: 10px;
      background: transparent; border: 1.5px solid rgba(255,255,255,0.15); border-radius: 4px;
      padding: 13px 20px; cursor: pointer;
      font-family: 'Syne', sans-serif; font-size: 13px; font-weight: 600;
      letter-spacing: 0.02em; color: rgba(255,255,255,0.45);
      transition: border-color 0.2s, color 0.2s;
    }
    .lla-btn-download:hover { border-color: rgba(255,255,255,0.35); color: rgba(255,255,255,0.75); }
    .lla-retake {
      background: none; border: none; font-family: 'DM Sans', sans-serif;
      font-size: 13px; color: rgba(255,255,255,0.22); cursor: pointer;
      margin-top: 14px; display: block; width: 100%; text-align: center; transition: color 0.2s;
    }
    .lla-retake:hover { color: rgba(255,255,255,0.5); }

    /* ─── Responsive ─── */
    @media (max-width: 768px) {
      .audit-nav { padding: 16px 20px; }
      .audit-page { padding: 90px 20px 48px; }
      .lla-results-grid { grid-template-columns: 1fr; gap: 36px; }
      .lla-input-row { flex-direction: column; align-items: flex-start; }
    }
  </style>
  <link href="https://assets.calendly.com/assets/external/widget.css" rel="stylesheet">
  <script src="https://assets.calendly.com/assets/external/widget.js" async></script>
</head>
<body>

  <!-- Minimal nav -->
  <nav class="audit-nav">
    <a href="index.html" class="audit-logo">
      TRADE<span>STACK</span><span class="audit-logo-badge">AI</span>
    </a>
    <a href="index.html" class="audit-nav-back">
      <svg width="14" height="14" fill="none" stroke="currentColor" stroke-width="2.5" viewBox="0 0 24 24"><path d="M19 12H5M12 5l-7 7 7 7"/></svg>
      Back to site
    </a>
  </nav>

  <div class="audit-wm">AUDIT</div>

  <main class="audit-page">
    <div class="lla-wrap">

      <!-- Panel: Intro -->
      <div class="lla-panel active" id="lla-p-intro">
        <div class="lla-eyebrow-amber">Lead Leak Audit</div>
        <h2 class="lla-h2">Find the gaps<br>costing you jobs.</h2>
        <p class="lla-lead">Answer 10 quick questions and get a personalised report showing exactly where your business is losing leads — and what it's costing you every year.</p>
        <div class="lla-cats-row">
          <span class="lla-cat-pill">Response Speed</span>
          <span class="lla-cat-pill">Lead Follow-Up</span>
          <span class="lla-cat-pill">Reviews</span>
          <span class="lla-cat-pill">Local Visibility</span>
          <span class="lla-cat-pill">Website</span>
        </div>
        <button class="lla-btn-primary" onclick="llaGoTo('value')">
          Start the Audit
          <svg width="17" height="17" fill="none" stroke="currentColor" stroke-width="2.5" viewBox="0 0 24 24"><path d="M5 12h14M12 5l7 7-7 7"/></svg>
        </button>
        <p class="lla-fine">Free · Takes 3 minutes · Personalised to your business</p>
      </div>

      <!-- Panel: Customer Value -->
      <div class="lla-panel" id="lla-p-value">
        <div class="lla-eyebrow-amber">Before we start</div>
        <h3 class="lla-qh">What's a new customer typically worth to you?</h3>
        <p class="lla-qlead">This lets us show you a real revenue figure in your results — specific to your business, not a generic number.</p>
        <div class="lla-input-row">
          <div class="lla-input-wrap">
            <span class="lla-curr">€</span>
            <input type="number" id="lla-val-input" class="lla-num-input" placeholder="e.g. 500" min="1">
          </div>
          <button class="lla-btn-primary" onclick="llaSetValue()">
            Begin Audit →
          </button>
        </div>
        <span class="lla-skip-link" onclick="llaSetValue(true)">Skip — use a typical estimate</span>
      </div>

      <!-- Panel: Quiz -->
      <div class="lla-panel" id="lla-p-quiz">
        <div class="lla-progress-track">
          <div class="lla-progress-fill" id="lla-pfill"></div>
        </div>
        <div class="lla-q-meta-row">
          <span class="lla-q-section-lbl" id="lla-qsection"></span>
          <span class="lla-q-counter" id="lla-qcount"></span>
        </div>
        <h3 class="lla-qh" id="lla-qtext"></h3>
        <div class="lla-opts" id="lla-opts"></div>
      </div>

      <!-- Panel: Lead Capture -->
      <div class="lla-panel" id="lla-p-capture">
        <div class="lla-eyebrow-amber">Your results are ready</div>
        <h3 class="lla-qh">Where should we<br>send your report?</h3>
        <p class="lla-qlead">We'll follow up with quick wins specific to your gaps — no generic advice.</p>
        <div class="lla-capture-fields">
          <input type="text" id="lla-cap-name" class="lla-text-input" placeholder="Your first name">
          <input type="text" id="lla-cap-business" class="lla-text-input" placeholder="Business name">
          <input type="tel" id="lla-cap-phone" class="lla-text-input" placeholder="Phone number">
          <input type="email" id="lla-cap-email" class="lla-text-input" placeholder="Email address">
          <p id="lla-cap-error" class="lla-capture-error">Please fill in all fields to see your results.</p>
        </div>
        <button class="lla-btn-primary" onclick="llaSubmitCapture()">
          See My Results
          <svg width="17" height="17" fill="none" stroke="currentColor" stroke-width="2.5" viewBox="0 0 24 24"><path d="M5 12h14M12 5l7 7-7 7"/></svg>
        </button>
        <p class="lla-privacy-note">No spam. We'll only use this to send your report and follow up once.</p>
      </div>

      <!-- Panel: Results (built dynamically) -->
      <div class="lla-panel" id="lla-p-results"></div>

    </div>
  </main>

<script>
  const LLA_Q = [
    { section: 'Response Speed', cat: 'response',
      text: 'When you\'re busy and miss a call, what typically happens?',
      opts: [
        ['I have something that responds automatically', 0],
        ['Someone else in the business handles it', 1],
        ['I call them back when I get a chance', 2],
        ['Honestly — some fall through the cracks', 3],
      ]
    },
    { section: 'Response Speed', cat: 'response',
      text: 'How quickly do you typically respond to a new enquiry?',
      opts: [
        ['Within 5 minutes', 0],
        ['Within the hour', 1],
        ['Same day', 2],
        ['Whenever I get a chance', 3],
      ]
    },
    { section: 'Lead Follow-Up', cat: 'followup',
      text: 'You send a quote or proposal and don\'t hear back — what do you do?',
      opts: [
        ['My system follows up automatically via SMS and email', 0],
        ['I follow up manually 2–3 times', 1],
        ['I send one follow-up and leave it', 2],
        ['Usually too busy to chase it up', 3],
      ]
    },
    { section: 'Lead Follow-Up', cat: 'followup',
      text: 'Do you have any automation in place for leads who go quiet?',
      opts: [
        ['Yes — fully automated sequences running', 0],
        ['I do it manually when I remember', 1],
        ['No, but I try to follow up by hand', 2],
        ['Nothing in place at all', 3],
      ]
    },
    { section: 'Reviews & Reputation', cat: 'reviews',
      text: 'After completing a job or appointment, do you ask for a Google review?',
      opts: [
        ['Yes — automatically, after every job', 0],
        ['Yes — I ask manually most of the time', 1],
        ['Sometimes, when I remember', 2],
        ['Rarely or never', 3],
      ]
    },
    { section: 'Reviews & Reputation', cat: 'reviews',
      text: 'How many Google reviews does your business currently have?',
      opts: [
        ['50 or more', 0],
        ['30–50', 1],
        ['10–30', 2],
        ['Under 10', 3],
      ]
    },
    { section: 'Local Visibility', cat: 'visibility',
      text: 'If someone searched your service + your area on Google right now, where do you appear?',
      opts: [
        ['Top 3 on Google Maps — I\'ve checked recently', 0],
        ['Somewhere on the first page', 1],
        ['I\'m honestly not sure', 2],
        ['I don\'t rank well or I\'m not visible', 3],
      ]
    },
    { section: 'Local Visibility', cat: 'visibility',
      text: 'How active is your Google Business Profile?',
      opts: [
        ['Regularly updated — posts, photos and offers', 0],
        ['Just the basic info — name, number, address', 1],
        ['Set it up years ago and haven\'t touched it', 2],
        ['Not sure if I have one properly set up', 3],
      ]
    },
    { section: 'Website & Tracking', cat: 'website',
      text: 'Can someone book, request a quote, or make an enquiry from your website right now?',
      opts: [
        ['Yes — fast, mobile-friendly, works great', 0],
        ['Yes — basic contact form, gets the job done', 1],
        ['No — they just get my phone number', 2],
        ['My site is outdated or I don\'t have one', 3],
      ]
    },
    { section: 'Website & Tracking', cat: 'website',
      text: 'Do you know which marketing activity is actually generating your leads?',
      opts: [
        ['Yes — I track everything (Analytics, CRM, call tracking)', 0],
        ['Roughly — I ask people how they found me', 1],
        ['Not really', 2],
        ['No idea', 3],
      ]
    },
  ];

  const LLA_CATS = {
    response:   { label: 'Response Speed',      service: 'Less Chasing' },
    followup:   { label: 'Lead Follow-Up',       service: 'Less Chasing' },
    reviews:    { label: 'Reviews & Reputation', service: 'Less Chasing' },
    visibility: { label: 'Local Visibility',     service: 'Own Your Area' },
    website:    { label: 'Website & Tracking',   service: 'More Leads' },
  };

  let llaS = { scores: [], cats: { response:0, followup:0, reviews:0, visibility:0, website:0 }, val: 500 };

  function llaGoTo(id) {
    document.querySelectorAll('.lla-panel').forEach(p => p.classList.remove('active'));
    document.getElementById('lla-p-' + id).classList.add('active');
    window.scrollTo({ top: 0, behavior: 'smooth' });
  }

  function llaSetValue(skip) {
    if (!skip) {
      const v = parseInt(document.getElementById('lla-val-input').value);
      llaS.val = (v && v > 0) ? v : 500;
    }
    llaS.scores = [];
    llaS.cats = { response:0, followup:0, reviews:0, visibility:0, website:0 };
    llaGoTo('quiz');
    llaRenderQ(0);
  }

  function llaRenderQ(i) {
    const q = LLA_Q[i];
    const total = LLA_Q.length;
    document.getElementById('lla-pfill').style.width = ((i / total) * 100) + '%';
    document.getElementById('lla-qsection').textContent = q.section;
    document.getElementById('lla-qcount').textContent = (i + 1) + ' of ' + total;
    document.getElementById('lla-qtext').textContent = q.text;
    const optsEl = document.getElementById('lla-opts');
    optsEl.innerHTML = '';
    q.opts.forEach(([text, score]) => {
      const btn = document.createElement('button');
      btn.className = 'lla-opt';
      btn.textContent = text;
      btn.addEventListener('click', function() {
        document.querySelectorAll('.lla-opt').forEach(b => b.classList.remove('selected'));
        this.classList.add('selected');
        llaS.scores[i] = score;
        llaS.cats[q.cat] += score;
        setTimeout(() => {
          if (i + 1 < total) { llaRenderQ(i + 1); }
          else { llaGoTo('capture'); }
        }, 380);
      });
      optsEl.appendChild(btn);
    });
  }

  var LLA_SHEET_URL = 'https://script.google.com/macros/s/AKfycbwYPBARIfiPlXeDjrAmnG9wF1kX3X-qV66wB-XMLlBONWO7-kK9wIviSkx6BJrJKPM/exec';

  function llaSubmitCapture() {
    const name     = document.getElementById('lla-cap-name').value.trim();
    const business = document.getElementById('lla-cap-business').value.trim();
    const phone    = document.getElementById('lla-cap-phone').value.trim();
    const email    = document.getElementById('lla-cap-email').value.trim();
    const errEl = document.getElementById('lla-cap-error');
    if (!name || !business || !phone || !email) { errEl.classList.add('show'); return; }
    errEl.classList.remove('show');
    llaS.lead = { name, business, phone, email };
    const total = llaS.scores.reduce((a, b) => a + b, 0);
    const annualLeak = Math.round((total / (LLA_Q.length * 3)) * 8) * llaS.val * 12;
    new Image().src = LLA_SHEET_URL + '?' + new URLSearchParams({ name, business, phone, email, annualLeak });
    llaShowResults();
  }

  function llaShowResults() {
    const total = llaS.scores.reduce((a, b) => a + b, 0);
    const max = LLA_Q.length * 3;
    const ratio = total / max;
    const leaksPerMonth = Math.round(ratio * 8);
    const annualLeak = leaksPerMonth * llaS.val * 12;

    let tierKey, tierLabel, tierDesc;
    if (total <= 9) {
      tierKey = 'solid'; tierLabel = 'Solid Foundation';
      tierDesc = 'You\'ve got some key pieces in place. Here\'s what\'s still leaking.';
    } else if (total <= 19) {
      tierKey = 'moderate'; tierLabel = 'Moderate Leaks Detected';
      tierDesc = 'You\'re losing leads across several areas. Here\'s exactly where.';
    } else {
      tierKey = 'critical'; tierLabel = 'Significant Revenue at Risk';
      tierDesc = 'Your competitors are taking jobs that should be yours. Here\'s the full picture.';
    }

    const catList = Object.entries(llaS.cats)
      .map(([cat, score]) => ({ cat, score, pct: Math.round((score / 6) * 100) }))
      .sort((a, b) => b.score - a.score);

    const gapsHTML = catList.map(({ cat, pct }) => {
      const info = LLA_CATS[cat];
      const cls = pct >= 67 ? 'major' : pct >= 34 ? 'moderate' : 'strong';
      const lbl = pct >= 67 ? 'Major Gap' : pct >= 34 ? 'Moderate Gap' : 'Strong';
      return `<div class="lla-gap-row">
        <div class="lla-gap-meta">
          <span class="lla-gap-name">${info.label}</span>
          <span class="lla-gap-tag lla-gap-tag-${cls}">${lbl}</span>
        </div>
        <div class="lla-gap-track">
          <div class="lla-gap-fill lla-gap-fill-${cls}" data-pct="${pct}"></div>
        </div>
        <div class="lla-gap-svc">Fixed by: <strong>${info.service}</strong></div>
      </div>`;
    }).join('');

    const resultsEl = document.getElementById('lla-p-results');
    resultsEl.innerHTML = `
      <div class="lla-results-grid">
        <div class="lla-res-left">
          <div class="lla-eyebrow-amber">Your Lead Leak Report</div>
          <div class="lla-tier-badge lla-tier-${tierKey}">${tierLabel}</div>
          <p class="lla-tier-desc">${tierDesc}</p>
          <div class="lla-leak-num" id="lla-counter">€0</div>
          <div class="lla-leak-lbl">estimated annual revenue at risk</div>
          <div class="lla-score-row">
            <span class="lla-score-lbl">Audit score</span>
            <span class="lla-score-val">${total}<span style="opacity:.3;font-size:.6em"> / ${max}</span></span>
          </div>
        </div>
        <div class="lla-res-right">
          <div class="lla-gaps-title">Your gap breakdown</div>
          ${gapsHTML}
          <div class="lla-res-cta">
            <a href="#" onclick="Calendly.initPopupWidget({url:'https://calendly.com/tradestackai-co/30min'});return false;" class="lla-btn-primary lla-res-cta-btn">
              See How We Could Help
              <svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2.5" viewBox="0 0 24 24"><path d="M5 12h14M12 5l7 7-7 7"/></svg>
            </a>
            <button class="lla-btn-download" onclick="llaDownload()">
              <svg width="14" height="14" fill="none" stroke="currentColor" stroke-width="2.5" viewBox="0 0 24 24"><path d="M12 3v13M5 14l7 7 7-7"/><path d="M3 21h18"/></svg>
              Download Your Full Lead Leak Report
            </button>
            <button class="lla-retake" onclick="llaReset()">← Retake the audit</button>
          </div>
        </div>
      </div>`;

    llaGoTo('results');

    const el = document.getElementById('lla-counter');
    const dur = 1800; const t0 = performance.now();
    const fmt = n => '€' + Math.round(n).toLocaleString('en-IE');
    (function tick(now) {
      const p = Math.min((now - t0) / dur, 1);
      const e = 1 - Math.pow(1 - p, 3);
      el.textContent = fmt(annualLeak * e);
      if (p < 1) requestAnimationFrame(tick);
    })(performance.now());

    setTimeout(() => {
      document.querySelectorAll('.lla-gap-fill').forEach(b => {
        b.style.width = b.dataset.pct + '%';
      });
    }, 150);
  }

  function llaDownload() {
    const total = llaS.scores.reduce((a, b) => a + b, 0);
    const max = LLA_Q.length * 3;
    const ratio = total / max;
    const annualLeak = Math.round(ratio * 8) * llaS.val * 12;
    const fmt = n => '€' + Math.round(n).toLocaleString('en-IE');

    const catList = Object.entries(llaS.cats)
      .map(([cat, score]) => ({ cat, score, pct: Math.round((score / 6) * 100) }))
      .sort((a, b) => b.score - a.score);

    const lines = [
      'LEAD LEAK REPORT — TradeStack AI',
      'Generated: ' + new Date().toLocaleDateString('en-IE', { day:'numeric', month:'long', year:'numeric' }),
      '═'.repeat(48), '',
      'ESTIMATED ANNUAL REVENUE AT RISK',
      fmt(annualLeak) + ' per year', '',
      'AUDIT SCORE: ' + total + ' / ' + max, '',
      '─'.repeat(48), 'YOUR GAP BREAKDOWN', '─'.repeat(48),
    ];
    catList.forEach(({ cat, pct }) => {
      const info = LLA_CATS[cat];
      const status = pct >= 67 ? 'MAJOR GAP' : pct >= 34 ? 'MODERATE GAP' : 'STRONG';
      const bar = '█'.repeat(Math.round(pct / 10)) + '░'.repeat(10 - Math.round(pct / 10));
      lines.push('', info.label + ' — ' + status, '[' + bar + '] ' + pct + '%', 'Fixed by: ' + info.service);
    });
    lines.push('', '─'.repeat(48), 'NEXT STEP', '─'.repeat(48), '',
      'Book a free call to see how we could help:', 'https://tradestack.ie', '',
      '═'.repeat(48), 'TradeStack AI — AI Marketing for Irish Trades & Services');

    const blob = new Blob([lines.join('\n')], { type: 'text/plain' });
    const a = document.createElement('a');
    a.href = URL.createObjectURL(blob);
    a.download = 'TradeStack-Lead-Leak-Report.txt';
    a.click();
    URL.revokeObjectURL(a.href);
  }

  function llaReset() {
    llaS = { scores: [], cats: { response:0, followup:0, reviews:0, visibility:0, website:0 }, val: 500 };
    const inp = document.getElementById('lla-val-input');
    if (inp) inp.value = '';
    ['lla-cap-name', 'lla-cap-business', 'lla-cap-phone', 'lla-cap-email'].forEach(id => {
      const el = document.getElementById(id); if (el) el.value = '';
    });
    const errEl = document.getElementById('lla-cap-error');
    if (errEl) errEl.classList.remove('show');
    llaGoTo('intro');
  }
</script>
</body>
</html>
